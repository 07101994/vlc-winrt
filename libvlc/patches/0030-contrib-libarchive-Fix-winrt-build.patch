From 5c249482bdacf86a992ca6df2fd00261bc92732c Mon Sep 17 00:00:00 2001
From: Steve Lhomme <robux4@ycbcr.xyz>
Date: Mon, 9 Apr 2018 09:59:27 +0200
Subject: [PATCH 30/30] contrib: libarchive: Fix winrt build

don't force compilation for Windows XP
---
 contrib/src/libarchive/winrt.patch | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)

diff --git a/contrib/src/libarchive/winrt.patch b/contrib/src/libarchive/winrt.patch
index 50258df..c1bf944 100644
--- a/contrib/src/libarchive/winrt.patch
+++ b/contrib/src/libarchive/winrt.patch
@@ -323,3 +323,26 @@
 +    return ARCHIVE_FATAL;
 +#endif
  }
+--- libarchive-3.3.2/configure.ac	2018-04-09 13:17:33.304520600 +0200
++++ libarchive-3.3.2/configure.ac.winstore	2018-04-09 13:17:40.471984000 +0200
+@@ -243,13 +243,13 @@ AM_CONDITIONAL([BUILD_BSDCPIO], [ test "
+ AM_CONDITIONAL([STATIC_BSDCPIO], [ test "$static_bsdcpio" = yes ])
+ 
+ # Set up defines needed before including any headers
+-case $host in
+-  *mingw* | *cygwin* | *msys*  )
+-  AC_DEFINE([_WIN32_WINNT], 0x0502, [Define to '0x0502' for Windows Server 2003 APIs.])
+-  AC_DEFINE([WINVER], 0x0502, [Define to '0x0502' for Windows Server 2003 APIs.])
+-  AC_DEFINE([NTDDI_VERSION], 0x05020000, [Define to '0x05020000' for Windows Server 2003 APIs.])
+-  ;;
+-esac
++# case $host in
++#   *mingw* | *cygwin* | *msys*  )
++#   AC_DEFINE([_WIN32_WINNT], 0x0502, [Define to '0x0502' for Windows Server 2003 APIs.])
++#   AC_DEFINE([WINVER], 0x0502, [Define to '0x0502' for Windows Server 2003 APIs.])
++#   AC_DEFINE([NTDDI_VERSION], 0x05020000, [Define to '0x05020000' for Windows Server 2003 APIs.])
++#   ;;
++# esac
+ 
+ # Checks for header files.
+ AC_HEADER_DIRENT
-- 
2.10.1.windows.1

