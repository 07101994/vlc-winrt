From 335532cde988988fdc7d0635722ba5eb35397a94 Mon Sep 17 00:00:00 2001
From: Steve Lhomme <robux4@videolabs.io>
Date: Wed, 25 Jan 2017 18:11:47 +0100
Subject: [PATCH 25/55] vout: win32: add a function to set the planes of a
 picture from the raw values

---
 modules/video_output/win32/common.c | 15 +++++++++++++++
 modules/video_output/win32/common.h |  1 +
 2 files changed, 16 insertions(+)

diff --git a/modules/video_output/win32/common.c b/modules/video_output/win32/common.c
index f2b97b88e3..6e502a2b2c 100644
--- a/modules/video_output/win32/common.c
+++ b/modules/video_output/win32/common.c
@@ -438,6 +438,21 @@ void CommonDisplay(vout_display_t *vd)
 }
 #endif
 
+int CommonUpdatePictureSplit(picture_t *picture, uint8_t **planes,
+                             unsigned *pitches, unsigned *heights)
+{
+    /* fill in buffer info in first plane */
+    for (int n = 0; n < picture->i_planes; n++) {
+        picture->p[n].p_pixels = planes[n];
+        picture->p[n].i_pitch  = pitches[n];
+        picture->p[n].i_lines  = heights[n];
+        assert(picture->p[n].i_visible_pitch <= picture->p[n].i_pitch);
+        assert(picture->p[n].i_visible_lines <= picture->p[n].i_lines);
+    }
+    return VLC_SUCCESS;
+
+}
+
 /**
  * It updates a picture data/pitches.
  */
diff --git a/modules/video_output/win32/common.h b/modules/video_output/win32/common.h
index a957048541..504038ccf2 100644
--- a/modules/video_output/win32/common.h
+++ b/modules/video_output/win32/common.h
@@ -95,6 +95,7 @@ void CommonManage(vout_display_t *);
 int  CommonControl(vout_display_t *, int , va_list );
 void CommonDisplay(vout_display_t *);
 int  CommonUpdatePicture(picture_t *, picture_t **fallback, uint8_t *plane, unsigned pitch);
+int  CommonUpdatePictureSplit(picture_t *, uint8_t **planes, unsigned *pitches, unsigned *heights);
 
 void UpdateRects (vout_display_t *,
                   const vout_display_cfg_t *,
-- 
2.11.0

