<Page x:Class="VLC_WINRT_APP.Views.MainPages.MainPageHome"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:VLC_WINRT_APP.Views.MainPages"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:musicPages="using:VLC_WINRT_APP.Views.MusicPages"
      xmlns:triggers="using:WinRT.Triggers"
      xmlns:controls="using:VLC_WINRT_APP.Controls"
      xmlns:userControls="using:VLC_WINRT_APP.Views.UserControls"
      xmlns:mainVideoControls="using:VLC_WINRT_APP.Views.MainPages.MainVideoControls"
      xmlns:mainMusicControls="using:VLC_WINRT_APP.Views.MainPages.MainMusicControls"
      xmlns:extensions="using:WinRTXamlToolkit.Controls.Extensions"
      mc:Ignorable="d"
      DataContext="{Binding Source={StaticResource Locator}, Path=MainVM}">

    <Grid Margin="0"
          DataContext="{Binding Source={StaticResource Locator}, Path=MusicLibraryVM}">
        <!--<Grid.RowDefinitions>
            <RowDefinition Height="60" />
            <RowDefinition />
        </Grid.RowDefinitions>-->
        <Grid Background="{StaticResource MainColor}"
              DataContext="{Binding Source={StaticResource Locator}, Path=MainVM}"
              Height="50"
              VerticalAlignment="Top" />
        <Grid Margin="0,50,0,0" Height="7"
              VerticalAlignment="Top">
           <Grid.Background>
               <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                   <GradientStop Color="#23000000" Offset="0"/>
                   <GradientStop Color="#00000000" Offset="1"/>
               </LinearGradientBrush>
           </Grid.Background>
        </Grid>
        <!--<Grid Grid.Row="0"
              Background="WhiteSmoke"
              VerticalAlignment="Top"
              DataContext="{Binding Source={StaticResource Locator}, Path=MainVM}">
            <Grid.RowDefinitions>
                <RowDefinition Height="20" />
                <RowDefinition />
                <RowDefinition Height="1" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid Background="{StaticResource MainColor}"
                  Grid.ColumnSpan="3"
                  Grid.Row="2" />
            <userControls:VLCLogoWithGradient Grid.Row="1"
                                              Margin="8,6,0,6" />
            <TextBlock x:Name="TitleTextBlock"
                       Grid.Column="1"
                       Grid.Row="1"
                       Style="{StaticResource TitleTextBlockStyle}"
                       Margin="6,-2,0,0"
                       VerticalAlignment="Center"
                       FontWeight="Light">
                <Run Text="VLC"
                     FontSize="28"
                     Foreground="{StaticResource MainColor}" />
            </TextBlock>
            <ListView x:Name="PanelsListView"
                      Grid.Column="2"
                      Grid.Row="1"
                      Margin="12,-3,-13,0"
                      ItemsSource="{Binding Panels}"
                      IsItemClickEnabled="False"
                      SelectionMode="Single"
                      SelectedIndex="{Binding ElementName=MainPivot, Path=SelectedIndex, Mode=TwoWay}"
                      VerticalAlignment="Center"
                      HorizontalAlignment="Right"
                      ItemContainerStyle="{StaticResource ListViewItemContainerStyleNoSelectCheck}"
                      ItemTemplate="{StaticResource SidebarMiniIconItemTemplate}"
                      ScrollViewer.VerticalScrollBarVisibility="Disabled">
                <triggers:Interactions.Triggers>
                    <triggers:EventTrigger EventName="SelectionChanged">
                        <triggers:InvokeCommandAction Command="{Binding GoToPanelCommand}"
                                                      PassEventArgsToCommand="True" />
                    </triggers:EventTrigger>
                </triggers:Interactions.Triggers>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>
        </Grid>-->
        <Image Source="/Assets/backgroundTop.png"
               Stretch="Uniform"
               VerticalAlignment="Top"
               Margin="0,50,0,0"
               extensions:ImageExtensions.FadeInOnLoaded="True" />
        <Pivot x:Name="MainPivot"
               x:FieldModifier="public"
               Margin="-7,15,-15,0"
               Style="{StaticResource PivotStyle1}"
               HeaderTemplate="{StaticResource PivotTitleTemplate}"
               SelectionChanged="MainPivot_OnSelectionChanged">
            <PivotItem Header="home">
                <Grid>
                    <ScrollViewer>
                        <StackPanel>
                            <StackPanel x:Name="MusicLibrary"
                                        DataContext="{Binding Source={StaticResource Locator}, Path=MusicLibraryVM}">
                                <Button Content="top albums"
                                        FontSize="30"
                                        Foreground="{StaticResource MainColor}"
                                        Style="{StaticResource TextBlockButtonStyle}"
                                        Command="{Binding Source={StaticResource Locator}, Path=MainVM.GoToPanelCommand}"
                                        CommandParameter="2" 
                                        FontWeight="SemiLight"/>
                                <GridView ItemsSource="{Binding RandomAlbums}"
                                          ItemTemplate="{StaticResource PhoneSemanticZoomInViewAlbumTemplateLittleSize}"
                                          IsItemClickEnabled="True"
                                          SelectionMode="None"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                          ScrollViewer.HorizontalScrollMode="Disabled"
                                          ScrollViewer.VerticalScrollMode="Disabled"
                                          Margin="0,6,0,0">
                                    <triggers:Interactions.Triggers>
                                        <triggers:EventTrigger EventName="ItemClick">
                                            <triggers:InvokeCommandAction Command="{Binding AlbumClickedCommand}"
                                                                          PassEventArgsToCommand="True" />
                                        </triggers:EventTrigger>
                                    </triggers:Interactions.Triggers>
                                    <GridView.ItemContainerTransitions>
                                        <TransitionCollection>
                                            <AddDeleteThemeTransition/>
                                            <EntranceThemeTransition />
                                        </TransitionCollection>
                                    </GridView.ItemContainerTransitions>
                                    <GridView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <ItemsWrapGrid Orientation="Horizontal"
                                                           SizeChanged="AlbumsWrapGrid_SizeChanged" />
                                        </ItemsPanelTemplate>
                                    </GridView.ItemsPanel>
                                </GridView>
                                <controls:NoFavoriteAlbumsControl HorizontalAlignment="Left" />
                            </StackPanel>
                            <StackPanel x:Name="VideoLibrary"
                                        DataContext="{Binding Source={StaticResource Locator}, Path=VideoLibraryVM}">
                                <Button Content="top videos"
                                        Margin="0,12,0,0"
                                        FontSize="30"
                                        Foreground="{StaticResource MainColor}"
                                        Style="{StaticResource TextBlockButtonStyle}"
                                        Command="{Binding Source={StaticResource Locator}, Path=MainVM.GoToPanelCommand}"
                                        CommandParameter="1"
                                        FontWeight="SemiLight"/>
                                <GridView ItemsSource="{Binding ViewedVideos}"
                                          ItemTemplate="{StaticResource PhoneCompactVideoTemplate}"
                                          Margin="0,6,-26,0"
                                          IsItemClickEnabled="True">
                                    <triggers:Interactions.Triggers>
                                        <triggers:EventTrigger EventName="ItemClick">
                                            <triggers:InvokeCommandAction Command="{Binding OpenVideo}"
                                                                          PassEventArgsToCommand="True" />
                                        </triggers:EventTrigger>
                                    </triggers:Interactions.Triggers>
                                    <GridView.ItemContainerTransitions>
                                        <TransitionCollection>
                                            <AddDeleteThemeTransition />
                                            <EntranceThemeTransition />
                                        </TransitionCollection>
                                    </GridView.ItemContainerTransitions>
                                    <GridView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <ItemsWrapGrid Orientation="Horizontal"
                                                           SizeChanged="VideoWrapGrid_SizeChanged"
                                                           Margin="0,0,0,60" />
                                        </ItemsPanelTemplate>
                                    </GridView.ItemsPanel>
                                </GridView>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </PivotItem>
            <PivotItem Header="videos">
                <local:MainPageVideos x:Name="MainPageVideoPivotItem"
                                      x:FieldModifier="public"/>
            </PivotItem>
            <PivotItem Header="music">
                <local:MainPageMusic x:Name="MainPageMusicPivotItem"
                                     x:FieldModifier="public" />
            </PivotItem>
            <PivotItem Header="sd card">
                <local:MainPageSDCard />
            </PivotItem>
        </Pivot>
    </Grid>
    <Page.BottomAppBar>
        <CommandBar Style="{StaticResource VLCCommandBarStyle}"
                    x:Name="CommandBar">
            <!--<AppBarButton Icon="Find"
                          x:Uid="Search1"
                          Label="search"
                          Command="{Binding Source={StaticResource Locator}, Path=MainVM.OpenSidebarCommand}" />
            <AppBarButton Icon="OpenFile"
                          x:Uid="OpenFile2"
                          Label="open file"
                          Command="{Binding Source={StaticResource Locator}, Path=VideoLibraryVM.PickVideo}" />
            <AppBarButton Label="open stream"
                          x:Uid="OpenNetworkStream2"
                          Icon="World">
                <AppBarButton.Flyout>
                    <Flyout Placement="Full">
                        <Grid>
                            <StackPanel VerticalAlignment="Center"
                                        Background="WhiteSmoke">
                                <TextBlock Text="Open a stream"
                                           Style="{StaticResource SubheaderTextBlockStyle}"
                                           Margin="12" />
                                <StackPanel Orientation="Horizontal"
                                            Margin="12">
                                    <TextBox Name="UrlTextBox"
                                             PlaceholderText="Enter a URL"
                                             Width="350" />
                                    <Button Style="{StaticResource TextBlockButtonStyle}"
                                            Margin="12,0,0,0"
                                            Command="{Binding Source={StaticResource Locator}, Path=VideoLibraryVM.PlayNetworkMRL}"
                                            CommandParameter="{Binding ElementName=UrlTextBox, Path=Text}">
                                        <Button.Content>
                                            <SymbolIcon Symbol="Accept" />
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Flyout>
                </AppBarButton.Flyout>
            </AppBarButton>-->
        </CommandBar>
    </Page.BottomAppBar>
</Page>
