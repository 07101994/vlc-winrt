<Page x:Class="VLC_WINRT_APP.Views.MusicPages.MusicPlayerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:VLC_WINRT_APP.Views.MusicPages"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:triggers="using:WinRT.Triggers"
      xmlns:userControls="using:VLC_WINRT_APP.Views.UserControls"
      mc:Ignorable="d"
      DataContext="{Binding Source={StaticResource Locator}, Path=MusicLibraryVM}">

    <Grid RequestedTheme="Light">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0"
              x:Name="HeaderGrid"
              Margin="-12,0,0,0"
              Height="170"
              Background="Black"
              RequestedTheme="Dark">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Image Grid.RowSpan="2"
                   Source="{Binding CurrentArtist.Picture}"
                   Stretch="UniformToFill"
                   Opacity="0.6" />
            <userControls:TopBar HeaderTextBlock="{Binding CurrentAlbum.Name}"
                                 HeaderBackground="#00ffffff" />
            <StackPanel Grid.Row="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center">
                <Image Source="{Binding CurrentAlbum.Picture}"
                       MaxHeight="200"
                       MaxWidth="200"
                       Margin="0,0,0,6" />
                <StackPanel Margin="12,0,0,0"
                            VerticalAlignment="Center">
                    <TextBlock Text="{Binding CurrentArtist.Name}"
                               Style="{StaticResource SubheaderTextBlockStyle}" />
                    <TextBlock Style="{StaticResource BaseTextBlockStyle}">
                        <Run Text="{Binding CurrentAlbum.Tracks.Count}" />
                        <Run Text="tracks" />
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </Grid>
        <Image Grid.Row="1"
               Source="/Assets/backgroundTop.png"
               Stretch="Uniform"
               VerticalAlignment="Top"/>

        <Pivot Grid.Row="1"
               Style="{StaticResource PivotStyle1}"
               HeaderTemplate="{StaticResource PivotTitleTemplate}">
            <PivotItem Header="playlist">
                <ListView ItemsSource="{Binding CurrentAlbum.Tracks}"
                          IsItemClickEnabled="True"
                          SelectionMode="None"
                          ItemTemplate="{StaticResource LightTrackTemplate}"
                          ItemContainerStyle="{StaticResource ListViewItemStyle}">
                    <triggers:Interactions.Triggers>
                        <triggers:EventTrigger EventName="ItemClick">
                            <triggers:InvokeCommandAction Command="{Binding TrackClickedCommand}"
                                                          PassEventArgsToCommand="True" />
                        </triggers:EventTrigger>
                    </triggers:Interactions.Triggers>
                </ListView>
            </PivotItem>
            <PivotItem Header="biography">
                <TextBlock Text="{Binding CurrentArtist.Biography}"
                           Style="{StaticResource BodyTextBlockStyle}" />
            </PivotItem>
            <PivotItem Header="popular albums">
                <GridView IsSwipeEnabled="False"
                          SelectionMode="None"
                          IsItemClickEnabled="True"
                          ItemsSource="{Binding CurrentArtist.OnlinePopularAlbumItems}"
                          ItemTemplate="{StaticResource PopularAlbumTemplate}">
                    <GridView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VariableSizedWrapGrid Orientation="Horizontal"
                                                   Loaded="VariableSizedWrapGrid_Loaded" />
                        </ItemsPanelTemplate>
                    </GridView.ItemsPanel>
                </GridView>
            </PivotItem>
            <PivotItem Header="similar artists">
                <GridView IsSwipeEnabled="False"
                          SelectionMode="None"
                          IsItemClickEnabled="True"
                          ItemsSource="{Binding CurrentArtist.OnlineRelatedArtists}"
                          ItemTemplate="{StaticResource SimilarArtistTemplate}">
                    <GridView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VariableSizedWrapGrid Orientation="Horizontal"
                                                   Loaded="VariableSizedWrapGrid_Loaded" />
                        </ItemsPanelTemplate>
                    </GridView.ItemsPanel>
                </GridView>
            </PivotItem>
        </Pivot>
    </Grid>
</Page>
